from glob import glob
import mdtraj as md
import numpy as np

contacts = [[6, 9], [57, 61], [80, 101], [50, 101], [49, 101], [80, 102], [5, 9], [127, 318], [47, 101], [35, 101], [52, 54], [178, 229], [312, 318], [131, 318], [48, 104], [9, 26], [15, 26], [8, 28], [54, 61], [196, 229], [21, 49], [9, 34], [183, 229], [47, 102], [5, 36], [9, 12], [127, 314], [304, 319], [53, 55], [55, 95], [8, 29], [5, 15], [134, 319], [54, 64], [81, 100], [8, 11], [55, 340], [54, 60], [131, 317], [127, 317], [134, 313], [54, 57], [183, 190], [48, 99], [55, 94], [57, 336], [52, 96], [9, 13], [301, 313], [55, 96], [127, 304], [301, 305], [8, 27], [91, 340], [55, 97], [66, 329], [7, 10], [138, 319], [55, 61], [55, 343], [80, 99], [56, 60], [7, 11], [11, 54], [55, 336], [9, 30], [35, 152], [55, 60], [55, 337], [56, 340], [9, 31], [37, 104], [53, 56], [54, 97], [56, 337], [56, 61], [54, 343], [7, 29], [94, 343], [95, 340], [31, 56], [27, 106], [33, 53], [32, 60], [94, 340], [56, 336], [35, 104], [56, 94], [61, 340], [31, 55], [20, 41], [33, 52], [56, 95], [101, 104], [31, 54], [86, 100], [32, 52], [94, 344], [81, 101], [52, 95], [91, 337], [11, 55], [11, 56], [32, 50], [87, 94], [64, 97], [33, 51], [8, 34], [10, 54], [57, 60], [61, 339], [71, 101], [10, 55], [7, 12], [32, 54], [58, 336], [53, 60], [88, 94], [59, 62], [64, 99], [179, 229], [86, 96], [52, 60], [59, 63], [90, 94]]

contacts_ins_shift = [[6, 9], [58, 62], [81, 102], [50, 102], [49, 102], [81, 103], [5, 9], [128, 319], [47, 102], [35, 102], [52, 55], [179, 230], [313, 319], [132, 319], [48, 105], [9, 26], [15, 26], [8, 28], [55, 62], [197, 230], [21, 49], [9, 34], [184, 230], [47, 103], [5, 36], [9, 12], [128, 315], [305, 320], [53, 56], [56, 96], [8, 29], [5, 15], [135, 320], [55, 65], [82, 101], [8, 11], [56, 341], [55, 61], [132, 318], [128, 318], [135, 314], [55, 58], [184, 191], [48, 100], [56, 95], [58, 337], [52, 97], [9, 13], [302, 314], [56, 97], [128, 305], [302, 306], [8, 27], [92, 341], [56, 98], [67, 330], [7, 10], [139, 320], [56, 62], [56, 344], [81, 100], [57, 61], [7, 11], [11, 55], [56, 337], [9, 30], [35, 153], [56, 61], [56, 338], [57, 341], [9, 31], [37, 105], [53, 57], [55, 98], [57, 338], [57, 62], [55, 344], [7, 29], [95, 344], [96, 341], [31, 57], [27, 107], [33, 53], [32, 61], [95, 341], [57, 337], [35, 105], [57, 95], [62, 341], [31, 56], [20, 41], [33, 52], [57, 96], [102, 105], [31, 55], [87, 101], [32, 52], [95, 345], [82, 102], [52, 96], [92, 338], [11, 56], [11, 57], [32, 50], [88, 95], [65, 98], [33, 51], [8, 34], [10, 55], [58, 61], [62, 340], [72, 102], [10, 56], [7, 12], [32, 55], [59, 337], [53, 61], [89, 95], [60, 63], [65, 100], [180, 230], [87, 97], [52, 61], [60, 64], [91, 95]]

distances = []
for i,traj in enumerate(sorted(glob('run2-*.h5'))):               
    traj = md.load(traj)                                         
    distance = md.compute_contacts(traj, contacts=contacts)
    distances.append(distance)
    print(2,i)

np.save('../randforest_distances2', distances)

distances = []
for i,traj in enumerate(sorted(glob('run3-*.h5'))):               
    traj = md.load(traj)                                         
    distance = md.compute_contacts(traj, contacts=contacts_ins_shift)
    distances.append(distance)
    print(3,i)

np.save('../randforest_distances3', distances)

distances = []
for i,traj in enumerate(sorted(glob('run4-*.h5'))):               
    traj = md.load(traj)                                         
    distance = md.compute_contacts(traj, contacts=contacts)
    distances.append(distance)
    print(4,i)

np.save('../randforest_distances4', distances)

distances = []
for i,traj in enumerate(sorted(glob('run5-*.h5'))):               
    traj = md.load(traj)                                         
    distance = md.compute_contacts(traj, contacts=contacts_ins_shift)
    distances.append(distance)
    print(5,i)

np.save('../randforest_distances5', distances)
